{% extends "layouts/base.html" %}
{% block title %}Universal File Converter - Guideline Template System{% endblock %}
{% block styles %}
{% include "partials/index_styles.html" %}
{% endblock %}
{% block body %}
{% include "partials/index_loading_overlay.html" %}

<div class="page-layout">
    <aside class="card sidebar-card">
        <h2>ğŸ”§ Cháº¿ Äá»™ Chuyá»ƒn Äá»•i</h2>
        
        <div class="sidebar-group">
            <label for="conversionMode">Chá»n cháº¿ Ä‘á»™:</label>
            <select id="conversionMode" onchange="switchMode(this.value)">
                <option value="classic">ğŸ“Š Excel Classic (DOCX)</option>
                <option value="universal">ğŸŒ Universal (Markdown)</option>
                <option value="guideline">ğŸ“‹ Guideline Template</option>
                <option value="custom">ğŸ¨ Custom Template</option>
            </select>
        </div>

        <div class="sidebar-group">
            <label for="sourceFormatSelect">ğŸ“ Äá»‹nh dáº¡ng gá»‘c</label>
            <select id="sourceFormatSelect">
                <option value="excel">Excel (.xlsx)</option>
                <option value="pdf">PDF</option>
                <option value="docx">DOCX</option>
                <option value="pptx">PPTX</option>
                <option value="image">Image (PNG, JPG)</option>
                <option value="code">Code (PY, R, JS)</option>
                <option value="notebook">Jupyter Notebook</option>
                <option value="other">KhÃ¡c</option>
            </select>
        </div>

        <div class="sidebar-group">
            <label for="targetFormatSelect">ğŸ“„ Äá»‹nh dáº¡ng Ä‘Ã­ch</label>
            <select id="targetFormatSelect">
                <option value="docx">DOCX (Word)</option>
                <option value="markdown">Markdown (MD)</option>
            </select>
        </div>

        <!-- Template Type (Guideline Mode Only) -->
        <div class="sidebar-group hidden" id="templateTypeGroup">
            <label for="templateType">ğŸ“‹ Loáº¡i Template:</label>
            <select id="templateType">
                <option value="excel_list">Excel/CSV List</option>
                <option value="word_document">Word Document</option>
                <option value="process">Process/SOP</option>
                <option value="policy">Policy/ChÃ­nh sÃ¡ch</option>
            </select>
        </div>

        <!-- Custom Template (Custom Mode Only) -->
        <div class="sidebar-group hidden" id="customTemplateGroup">
            <label for="customTemplateSelect">ğŸ“ Sáºµn cÃ³ template:</label>
            <select id="customTemplateSelect" onchange="loadPredefinedTemplate()">
                <option value="">-- Táº¡o má»›i --</option>
                <option value="excel">Excel Template</option>
                <option value="document">Document Template</option>
                <option value="process">Process Template</option>
                <option value="policy">Policy Template</option>
            </select>
        </div>
    </aside>

    <main class="card main-card">
        {% include "partials/index_header.html" %}
        
        <!-- Classic Mode -->
        <div id="classicMode" class="mode-section">
            {% include "partials/index_steps.html" %}
        </div>

        <!-- Universal Mode -->
        <div id="universalMode" class="mode-section hidden">
            {% include "partials/universal_steps.html" %}
        </div>

        <!-- Guideline Template Mode -->
        <div id="guidelineMode" class="mode-section hidden">
            {% include "partials/guideline_steps.html" %}
        </div>

        <!-- Custom Template Mode -->
        <div id="customMode" class="mode-section hidden">
            {% include "partials/custom_template_steps.html" %}
        </div>

        {% include "partials/index_status_and_download.html" %}
    </main>
</div>

{% endblock %}
{% block scripts %}
{% include "partials/index_scripts.html" %}
{% include "partials/guideline_scripts.html" %}
{% endblock %}
